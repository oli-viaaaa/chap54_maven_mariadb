-- hr2 데이터베이스 테이블 생성
```sql
-- hr2 계정으로 접속해서 작업 // ------------------------------------------------------------
-- hr2 계정으로 접속해서 작업 // ------------------------------------------------------------

CREATE TABLE regions (
  region_id INT PRIMARY KEY,
  region_name VARCHAR(25)
);

CREATE TABLE countries (
  country_id CHAR(2) PRIMARY KEY,
  country_name VARCHAR(40),
  region_id INT,
  CONSTRAINT countr_reg_fk FOREIGN KEY (region_id) REFERENCES regions(region_id)
);

CREATE TABLE locations (
  location_id INT PRIMARY KEY,
  street_address VARCHAR(40),
  postal_code VARCHAR(12),
  city VARCHAR(30) NOT NULL,
  state_province VARCHAR(25),
  country_id CHAR(2),
  CONSTRAINT loc_c_id_fk FOREIGN KEY (country_id) REFERENCES countries(country_id)
);

-- 외래키(foreign key) 있을때 강제 삭제하는 방법
-- 우선 외래키 제약 삭제하고 그 다음에 테이블 삭제
ALTER TABLE departments DROP FOREIGN KEY dept_mgr_fk;

CREATE TABLE departments (
  department_id INT PRIMARY KEY,
  department_name VARCHAR(30) NOT NULL,
  manager_id INT,
  location_id INT,
  CONSTRAINT dept_loc_fk FOREIGN KEY (location_id) REFERENCES locations(location_id)
);


CREATE TABLE jobs (
  job_id VARCHAR(10) PRIMARY KEY,
  job_title VARCHAR(35) NOT NULL,
  min_salary INT,
  max_salary INT
);

CREATE TABLE job_grades (
  grade_level VARCHAR(3) PRIMARY KEY,
  lowest_sal INT,
  highest_sal INT
);


CREATE TABLE employees
( employee_id    INT(6) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  first_name     VARCHAR(20),
  last_name      VARCHAR(25) NOT NULL,
  email          VARCHAR(25),
  phone_number   VARCHAR(20),
  hire_date      DATE DEFAULT CURRENT_TIMESTAMP,
  job_id         VARCHAR(10),
  salary         INT(8) DEFAULT 0,
  commission_pct INT(2) DEFAULT 0,
  manager_id     INT(6),
  department_id  INT(4),
  CONSTRAINT emp_job_fk FOREIGN KEY (job_id) REFERENCES jobs(job_id),
  CONSTRAINT emp_manager_fk FOREIGN KEY (manager_id) REFERENCES employees(employee_id),
  CONSTRAINT emp_dept_fk FOREIGN KEY (department_id) REFERENCES departments(department_id)
);

-- ALTER TABLE departments
-- ADD CONSTRAINT dept_mgr_fk FOREIGN KEY (manager_id) REFERENCES employees(employee_id);

CREATE TABLE job_history (
  employee_id INT NOT NULL,
  start_date DATE NOT NULL,
  end_date DATE NOT NULL,
  job_id VARCHAR(10) NOT NULL,
  department_id INT,
  PRIMARY KEY (employee_id, start_date),
  CONSTRAINT jhist_date_interval CHECK (end_date > start_date),
  CONSTRAINT jhist_job_fk FOREIGN KEY (job_id) REFERENCES jobs(job_id),
  CONSTRAINT jhist_emp_fk FOREIGN KEY (employee_id) REFERENCES employees(employee_id),
  CONSTRAINT jhist_dept_fk FOREIGN KEY (department_id) REFERENCES departments(department_id)
);

-- Please note that you
-- Sample data insertion
INSERT INTO regions (region_id, region_name) VALUES (1, 'Europe');
INSERT INTO regions (region_id, region_name) VALUES (2, 'Americas');
INSERT INTO regions (region_id, region_name) VALUES (3, 'Asia');
INSERT INTO regions (region_id, region_name) VALUES (4, 'Middle East and Africa');
--select * from regions;

INSERT INTO countries (country_id, country_name, region_id) VALUES ('CA', 'Canada', 2);
INSERT INTO countries (country_id, country_name, region_id) VALUES ('DE', 'Germany', 1);
INSERT INTO countries (country_id, country_name, region_id) VALUES ('UK', 'United Kingdom', 1);
INSERT INTO countries (country_id, country_name, region_id) VALUES ('US', 'United States of America', 2);

INSERT INTO locations (location_id, street_address, postal_code, city, state_province, country_id) 
VALUES (1400, '2014 Jabberwocky Rd', '26192', 'Southlake', 'Texas', 'US');
INSERT INTO locations (location_id, street_address, postal_code, city, state_province, country_id) 
VALUES (1500, '2011 Interiors Blvd', '99236', 'South San Francisco', 'California', 'US');
INSERT INTO locations (location_id, street_address, postal_code, city, state_province, country_id) 
VALUES (1700, '2004 Charade Rd', '98199', 'Seattle', 'Washington', 'US');
INSERT INTO locations (location_id, street_address, postal_code, city, state_province, country_id) 
VALUES (1800, '147 Spadina Ave', 'M5V 2L7', 'Toronto', 'Ontario', 'CA');
INSERT INTO locations (location_id, street_address, postal_code, city, state_province, country_id) 
VALUES (2500, 'Magdalen Centre, The Oxford Science Park', 'OX9 9ZB', 'Oxford', 'Oxford', 'UK');

Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (10,'Administration',200,1700);
Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (20,'Marketing',201,1800);
Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (50,'Shipping',124,1500);
Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (60,'IT',103,1400);
Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (80,'Sales',149,2500);
Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (90,'Executive',100,1700);
Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (110,'Accounting',205,1700);
Insert into DEPARTMENTS (DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) values (190,'Contracting',null,1700);

Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('AD_PRES','사장',20000,40000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('AD_VP','관리 부사장',15000,30000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('AD_ASST','관리 보조역',3000,6000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('AC_MGR','회계 관리자',8200,16000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('AC_ACCOUNT','회계사',4200,9000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('SA_MAN','영업관리자',10000,20000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('SA_REP','영업담당자',6000,12000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('ST_MAN','증권관리자',5500,8500);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('ST_CLERK','증권사무원',2000,5000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('IT_PROG','IT프로그램 개발자',4000,10000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('MK_MAN','마케팅 매니저',9000,15000);
Insert into JOBS (JOB_ID,JOB_TITLE,MIN_SALARY,MAX_SALARY) values ('MK_REP','마케팅 담당자',4000,9000);
   

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (100, '스티븐', '킹', 'SKING', '515.123.4567', STR_TO_DATE('87/01/08', '%y/%m/%d'), 'AD_PRES', 24000, NULL, NULL, 90);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (101, '니나', '코커', 'NKOCHHAR', '515.123.4568', STR_TO_DATE('90/02/08', '%y/%m/%d'), 'AD_VP', 17000, NULL, 100, 90);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (102, '렉스', '데이안', 'LDEHAAN', '515.123.4569', STR_TO_DATE('92/03/08', '%y/%m/%d'), 'AD_VP', 17000, NULL, 100, 90);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (103, '알렉산더', '휴놀드', 'AHUNOLD', '590.423.4567', STR_TO_DATE('93/04/08', '%y/%m/%d'), 'IT_PROG', 9000, NULL, 102, 60);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (104, '부르스', '어니스트', 'BERNST', '590.423.4568', STR_TO_DATE('95/05/10', '%y/%m/%d'), 'IT_PROG', 6000, NULL, 103, 60);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (107, '다이에나', '로렌츠', 'DLORENTZ', '590.423.5567', STR_TO_DATE('85/06/08', '%y/%m/%d'), 'IT_PROG', 4200, NULL, 103, 60);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (124, '케빈', '무고스', 'KMOURGOS', '650.123.5234', STR_TO_DATE('86/07/08', '%y/%m/%d'), 'ST_MAN', 5800, NULL, 100, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (141, '트레나', '라자스', 'TRAJS', '650.121.8009', STR_TO_DATE('80/08/08', '%y/%m/%d'), 'ST_CLERK', 3500, NULL, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (142, '쿠르츠', '데이비스', 'CDAVIES', '650.121.2994', STR_TO_DATE('95/09/08', '%y/%m/%d'), 'ST_CLERK', 3100, NULL, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (143, '란달', '마토스', 'RMATOS', '650.121.2874', STR_TO_DATE('96/10/08', '%y/%m/%d'), 'ST_CLERK', 2600, NULL, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (144, '피터', '바가스', 'PVARGAS', '650.121.2004', STR_TO_DATE('20/11/08', '%y/%m/%d'), 'ST_CLERK', 2500, NULL, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (149, '엘레니', '즐롯키', 'EZLOTKEY', '011.44.1344.429018', STR_TO_DATE('97/04/08', '%y/%m/%d'), 'SA_MAN', 10500, 0.2, 100, 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (174, '엘렌', '아벨', 'EABEL', '011.44.1644.429267', STR_TO_DATE('21/05/08', '%y/%m/%d'), 'SA_REP', 11000, 0.3, 149, 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (176, '조나단', '테일러', 'JTAYLOR', '011.44.1644.429265', STR_TO_DATE('01/07/08', '%y/%m/%d'), 'SA_REP', 8600, 0.2, 149, 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (178, '킴벌리', '그랜트', 'KGRANT', '011.44.1644.429263', STR_TO_DATE('97/03/08', '%y/%m/%d'), 'SA_REP', 7000, 0.15, 149, NULL);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (200, '제니퍼', '할른', 'JWHALEN', '515.123.4444', STR_TO_DATE('98/08/08', '%y/%m/%d'), 'AD_ASST', 4400, NULL, 101, 10);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (201, '마이클', '헤르츠테인', 'MHARTSTE', '515.123.5555', STR_TO_DATE('99/12/08', '%y/%m/%d'), 'MK_MAN', 13000, NULL, 100, 20);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (202, '팻', '페이', 'PFAY', '603.123.6666', STR_TO_DATE('88/11/08', '%y/%m/%d'), 'MK_REP', 6000, NULL, 201, 20);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (205, '셀리', '히긴스', 'SHIGGINS', '515.123.8080', STR_TO_DATE('91/05/08', '%y/%m/%d'), 'AC_MGR', 12000, NULL, 101, 110);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (206, '윌리암', '게이츠', 'WGIETZ', '515.123.8181', STR_TO_DATE('02/06/08', '%y/%m/%d'), 'AC_ACCOUNT', 8300, NULL, 205, 110);

INSERT INTO EMPLOYEES (FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES ('호동', '강', 'WGIETZ', '515.123.8181', STR_TO_DATE('02/06/08', '%y/%m/%d'), 'AC_ACCOUNT', 8300, NULL, 205, 110);


commit;

select * from employees;


		SELECT  EMPLOYEE_ID,
		    FIRST_NAME,
		    LAST_NAME,
		    EMAIL,
		    PHONE_NUMBER,
		    TO_CHAR(HIRE_DATE, 'YYYY-MM-DD') AS HIREDATE,
		    JOB_ID,
		    SALARY,
		    COMMISSION_PCT,
		    MANAGER_ID,
		    DEPARTMENT_ID 
		FROM EMPLOYEES 
		WHERE ROWNUM < 10
		ORDER BY EMPLOYEE_ID;
        
SELECT  E.EMPLOYEE_ID,
		    E.FIRST_NAME,
		    E.LAST_NAME,
		    E.EMAIL,
		    E.PHONE_NUMBER,
		    TO_CHAR(E.HIRE_DATE, 'YYYY-MM-DD') AS HIREDATE,
		    E.JOB_ID,
		    E.SALARY,
		    E.COMMISSION_PCT,
		    E.MANAGER_ID,
            E2.FIRST_NAME ||' '|| E2.LAST_NAME AS MANAGER_NAME,
		    E.DEPARTMENT_ID,
            D.DEPARTMENT_NAME
FROM EMPLOYEES E LEFT OUTER JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
INNER JOIN EMPLOYEES E2 ON E.MANAGER_ID = E2.EMPLOYEE_ID
WHERE 1=1
    AND E.FIRST_NAME LIKE '%'||'트레나'||'%'
    AND D.DEPARTMENT_NAME LIKE '%'||'Shipping'||'%'
ORDER BY E.EMPLOYEE_ID;

SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, E.EMAIL, E.PHONE_NUMBER, TO_CHAR(E.HIRE_DATE, 
'YYYY-MM-DD') AS HIREDATE, E.JOB_ID, E.SALARY, E.COMMISSION_PCT, E2.FIRST_NAME ||' '|| E2.LAST_NAME 
AS MANAGER_NAME, E.DEPARTMENT_ID, D.DEPARTMENT_NAME 
FROM EMPLOYEES E LEFT OUTER JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID 
INNER JOIN EMPLOYEES E2 ON E.MANAGER_ID = E2.EMPLOYEE_ID 
ORDER BY E.EMPLOYEE_ID ;

SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, E.EMAIL, E.PHONE_NUMBER, TO_CHAR(E.HIRE_DATE, 
'YYYY-MM-DD') AS HIREDATE, E.JOB_ID, E.SALARY, E.COMMISSION_PCT, E2.FIRST_NAME ||' '|| E2.LAST_NAME 
AS MANAGER_NAME, E.DEPARTMENT_ID, D.DEPARTMENT_NAME FROM EMPLOYEES E LEFT OUTER JOIN DEPARTMENTS 
D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID INNER JOIN EMPLOYEES E2 ON E.MANAGER_ID = E2.EMPLOYEE_ID 
WHERE 1=1 AND E.FIRST_NAME LIKE '%'||'라자스'||'%' AND D.DEPARTMENT_NAME LIKE '%'||'Shipping'||'%' 
ORDER BY E.EMPLOYEE_ID; 

INSERT INTO EMPLOYEES(
        	FIRST_NAME,
        	LAST_NAME,
        	EMAIL,
        	PHONE_NUMBER,
        	HIRE_DATE,
        	JOB_ID,
        	SALARY,
        	COMMISSION_PCT,
        	MANAGER_ID,
        	DEPARTMENT_ID) 
		VALUES (
			 '정희'
			, '안'
			, 'dream@a.com'
			, NULL
			, STR_TO_DATE('2023/06/05', '%y/%m/%d')
			, NULL
			, 50000
			, NULL
			, NULL
			, NULL
		);



